## âœ… ä¸€ã€ä»€ä¹ˆæ˜¯ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDIPï¼‰ï¼Ÿ

> **ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependency Inversion Principleï¼‰æ˜¯ SOLID äº”å¤§è®¾è®¡åŸåˆ™ä¹‹ä¸€ã€‚**

### ğŸŒŸ å®šä¹‰ï¼š

> é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–äºæŠ½è±¡ï¼›
>
> æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚

---

## âœ… äºŒã€é€šä¿—ç†è§£

### ğŸ”§ å¸¸è§é”™è¯¯ä¾èµ–ï¼š

```
é«˜å±‚æ¨¡å—ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰
     â†“ ä¾èµ–
ä½å±‚æ¨¡å—ï¼ˆæ•°æ®åº“ã€ç½‘ç»œã€é©±åŠ¨ç­‰ï¼‰

```

âœ… æ­£ç¡®ä¾èµ–æ–¹å¼ï¼ˆDIPï¼‰ï¼š

```
é«˜å±‚æ¨¡å— ----> æ¥å£ï¼ˆæŠ½è±¡ï¼‰ <---- ä½å±‚æ¨¡å—

```

* é«˜å±‚æ¨¡å—ä¾èµ–æŠ½è±¡ï¼ˆæ¥å£ï¼‰
* ä½å±‚æ¨¡å—ä¹Ÿå®ç°æ¥å£ï¼Œåè¿‡æ¥ä¾èµ–æŠ½è±¡
* æ§åˆ¶åè½¬ï¼ˆIoCï¼‰+ ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰æ˜¯å®ç°æ‰‹æ®µ

---

## âœ… ä¸‰ã€ä¸¾ä¸ªä¾‹å­ï¼ˆè¿å vs éµå®ˆï¼‰

### ğŸ”´ è¿åä¾èµ–å€’ç½®ï¼š

```c++
class MySQLDatabase {
public:
    void connect() {
        std::cout << "Connect to MySQL\n";
    }
};

class UserService {
private:
    MySQLDatabase db;  // âŒ ç›´æ¥ä¾èµ–ä½å±‚ç»†èŠ‚
public:
    void getUser() {
        db.connect();
        std::cout << "Get user\n";
    }
};

```

ğŸ‘ é—®é¢˜ï¼š

* `UserService` é«˜å±‚æ¨¡å—ä¾èµ–äº†å…·ä½“çš„ `MySQLDatabase`
* å°†æ¥è¦æ¢æ•°æ®åº“ï¼ˆå¦‚ PostgreSQLï¼‰è¦æ”¹ UserService ä»£ç 

---

### âœ… éµå®ˆä¾èµ–å€’ç½®ï¼š

```c++
// æŠ½è±¡æ¥å£
class IDatabase {
public:
    virtual void connect() = 0;
    virtual ~IDatabase() {}
};

// ä½å±‚æ¨¡å—å®ç°æ¥å£
class MySQLDatabase : public IDatabase {
public:
    void connect() override {
        std::cout << "Connect to MySQL\n";
    }
};

class UserService {
private:
    IDatabase* db;  // ä¾èµ–äºæŠ½è±¡ âœ…
public:
    UserService(IDatabase* database) : db(database) {}

    void getUser() {
        db->connect();
        std::cout << "Get user\n";
    }
};

```

ğŸ‘† ä¼˜ç‚¹ï¼š

* `UserService` åªä¾èµ– `IDatabase` æŠ½è±¡ï¼Œä¸ä¾èµ–å…·ä½“ç±»
* æ”¯æŒæœªæ¥æ‰©å±•ï¼ˆæ¯”å¦‚ PostgreSQLã€SQLiteï¼‰
* å¯ä»¥ç”¨ mock å®ç°åšæµ‹è¯•ï¼Œç¬¦åˆå¼€é—­åŸåˆ™

---

## âœ… å››ã€ä¾èµ–å€’ç½®åŸåˆ™æ ¸å¿ƒè¦ç‚¹

| åŸåˆ™             | è§£é‡Š                                   |
| ---------------- | -------------------------------------- |
| é«˜å±‚æ¨¡å—ä¾èµ–æŠ½è±¡ | æ¯”å¦‚ä¸šåŠ¡é€»è¾‘ä¾èµ–æ¥å£ï¼Œä¸ä¾èµ–å…·ä½“å®ç°ç±» |
| ä½å±‚æ¨¡å—å®ç°æŠ½è±¡ | æ•°æ®åº“ã€é©±åŠ¨ã€API ç­‰ç»†èŠ‚é€šè¿‡æ¥å£æš´éœ²   |
| æŠ½è±¡ä¸ä¾èµ–äºç»†èŠ‚ | æ¥å£ç¨³å®šã€å®ç°å¯å˜                     |
| ç»†èŠ‚ä¾èµ–äºæŠ½è±¡   | å®ç°ç±»å»éµå¾ªæ¥å£å®šä¹‰                   |

---

## âœ… äº”ã€å¦‚ä½•å®ç° DIP

| æ–¹æ³•            | æè¿°                                   |
| --------------- | -------------------------------------- |
| æ¥å£ç¼–ç¨‹        | ç”¨çº¯è™šç±»ï¼ˆC++ï¼‰æˆ–å‡½æ•°æŒ‡é’ˆï¼ˆCï¼‰         |
| ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰  | å°†ä¾èµ–ä»æ„é€ å‡½æ•°ã€set å‡½æ•°æˆ–å‚æ•°ä¼ å…¥   |
| æ§åˆ¶åè½¬ï¼ˆIoCï¼‰ | é«˜å±‚æ¨¡å—ä¸åˆ›å»ºåº•å±‚å¯¹è±¡ï¼Œç”±å¤–éƒ¨å®¹å™¨æ§åˆ¶ |

---

## âœ… å…­ã€ä¸å…¶ä»–è®¾è®¡æ¨¡å¼çš„å…³ç³»

| æ¨¡å¼/åŸåˆ™    | è¯´æ˜                                   |
| ------------ | -------------------------------------- |
| å·¥å‚æ¨¡å¼     | é€šè¿‡å·¥å‚è¿”å›æ¥å£ï¼Œå®ç°ä¾èµ–æŠ½è±¡         |
| ç­–ç•¥æ¨¡å¼     | å°†è¡Œä¸ºå°è£…ä¸ºæ¥å£ï¼Œå®ç°â€œç»†èŠ‚ä¾èµ–æŠ½è±¡â€ |
| æœåŠ¡æ³¨å†Œä¸­å¿ƒ | ç®¡ç†æŠ½è±¡åˆ°å®ç°çš„æ˜ å°„ï¼Œé…åˆ IoC å®¹å™¨    |

---

## âœ… ä¸ƒã€æ€»ç»“ä¸€å¥è¯

> **ä¾èµ–å€’ç½®åŸåˆ™çš„æ ¸å¿ƒï¼šä¾èµ–æŠ½è±¡ï¼Œè€Œä¸æ˜¯å…·ä½“å®ç°ã€‚**
>
> è¿™æœ‰åŠ©äºå®ç°æ¾è€¦åˆã€å¯æµ‹è¯•ã€æ˜“æ‰©å±•çš„ç³»ç»Ÿæ¶æ„ã€‚
>
